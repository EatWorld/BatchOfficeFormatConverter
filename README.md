# Office旧格式批量转换工具 (DOC转DOCX, XLS转XLSX)

## 简介
本工具提供了一个现代化的图形用户界面（GUI），帮助用户批量将指定目录及其子目录下的旧版 Microsoft Office 文件（`.doc` 和 `.xls`）转换为现代格式（`.docx` 和 `.xlsx`）。工具支持中英文双语界面，具有直观的操作界面和实时的转换进度显示。
**兼容WPS文档及表格，WPS文件均可转换。**

## 功能特性

### 🖥️ 现代化GUI界面
- **双语支持**: 支持中文和英文界面切换
- **现代化设计**: 采用现代扁平化设计风格，界面美观易用
- **实时进度**: 显示转换进度条和详细统计信息
- **日志系统**: 实时显示转换日志，支持日志保存和清除
![软件界面截图](docs/images/1748459334414.jpg)
### 📁 文件转换功能
1. **格式转换**:
   - Microsoft Word 文档: `.doc` 转换为 `.docx`
   - Microsoft Excel 表格: `.xls` 转换为 `.xlsx`
   - 支持选择性转换（可单独选择DOC或XLS转换）

2. **时间戳保留**:
   - 可选择是否保留原文件的创建时间、最后访问时间和最后修改时间
   - 智能重试机制处理文件占用情况

3. **原文件处理**:
   - **备份到默认文件夹**: 将原文件移动到"旧格式文件"文件夹
   - **备份到自定义文件夹**: 用户可指定备份位置
   - **不备份**: 转换后保留原文件在原位置

### 🔧 智能处理
- **递归处理**: 自动遍历指定目录及其所有子目录
- **智能跳过**: 自动检测并跳过密码保护文件和损坏文件
- **错误处理**: 完善的错误处理机制，确保程序稳定运行
- **幂等性**: 重复运行安全，已转换文件不会重复处理

### 📊 实时监控
- **进度条**: 显示当前转换进度
- **统计信息**: 实时显示可转换文件数、已转换数、跳过数和错误数
- **状态指示**: 清晰的状态指示器显示当前操作状态
- **详细日志**: 完整的操作日志，包括成功、警告和错误信息

## 系统要求
- **操作系统**: Windows (使用 `win32com` 与 Microsoft Office 交互)
- **Python版本**: Python 3.x
- **依赖库**:
  - `pywin32`: 用于与Windows COM对象交互
  - `tkinter`: GUI界面库（Python内置）
  - 安装命令: `pip install pywin32`
- **软件**: **已安装并已激活的** Microsoft Office (Word 和 Excel 2007或更高版本)

## 安装与使用

### 1. 环境准备
```bash
# 安装依赖
pip install pywin32
```

### 2. 运行程序
```bash
# 运行GUI版本
python office_converter_gui.py

# 或使用批处理文件（Windows）
启动GUI转换工具.bat
```
# 或使用WINDOWS的应用程序版本


### 3. 使用步骤
1. **选择源目录**: 点击"浏览"按钮选择要转换的文件夹
2. **配置转换选项**:
   - 选择要转换的文件类型（DOC/XLS）
   - 选择是否保留时间戳
   - 选择原文件处理方式
3. **开始转换**: 点击"开始转换"按钮
4. **监控进度**: 查看进度条和日志信息
5. **完成**: 转换完成后会显示统计结果

## 界面预览

![软件界面截图](docs/images/1748459334414.jpg)

### 主界面功能区域
- **左侧控制面板**: 目录选择、转换选项、原文件处理设置
- **右侧日志区域**: 实时转换日志显示
- **底部状态栏**: 进度条、状态指示和统计信息
- **顶部菜单**: 语言切换、帮助信息

### 转换选项说明
- **DOC转换**: 将.doc文件转换为.docx格式
- **XLS转换**: 将.xls文件转换为.xlsx格式
- **保留时间戳**: 保持原文件的时间属性
- **原文件处理**:
  - 备份到默认文件夹（推荐）
  - 备份到自定义文件夹
  - 不备份原文件

## 注意事项
- 运行前建议关闭所有 Microsoft Office 应用程序
- **强烈建议在处理重要数据前进行备份**
- 确保 Microsoft Office 已完全激活
- 建议将工作目录添加到 Office 的"受信任位置"
- 以管理员身份运行可避免权限问题

## 常见问题

### 依赖问题
**Q: 提示 `ModuleNotFoundError: No module named 'win32com'`**
A: 安装pywin32库：`pip install pywin32`

### Office相关
**Q: 转换时出现COM错误**
A: 
1. 确保 Microsoft Office 已完全激活
2. 将工作目录添加到Office受信任位置
3. 关闭所有Office程序后重试

### 权限问题
**Q: 文件移动失败，提示权限不足**
A: 以管理员身份运行程序

## 文件结构
```
BatchOfficeFormatConverter/
├── office_converter_gui.py    # GUI主程序
├── office_converter.py        # 命令行版本
├── run_gui.py                 # GUI启动器
├── 启动GUI转换工具.bat        # Windows批处理启动文件
├── README.md                  # 说明文档
└── docs/                      # 文档目录
    └── images/                # 图片资源
        └── gui-screenshot.png # 界面截图
```

## 版本信息
- **当前版本**: GUI v2.0
- **Python兼容**: Python 3.x
- **Office兼容**: Microsoft Office 2007及以上版本，WPS所有版本
- **最后更新**: 添加了现代化GUI界面，支持双语切换和实时进度监控

## 开源协议
本项目采用 MIT 协议开源，欢迎贡献代码和反馈问题。

---

**提示**: 如果您喜欢这个工具，请给项目点个⭐Star，这对我们很重要！
